<div
  class="min-h-screen w-full  bg-gradient-to-tr from-indigo-950 via-purple-950 to-pink-950  text-white relative overflow-hidden px-6 py-14 font-inter rounded-2xl"
>

  <!-- ‚ú® Floating Magical Glows -->
  <div class="absolute top-10 left-16 w-[500px] h-[500px] bg-pink-500/20 rounded-full blur-[220px] animate-pulse-slow"></div>
  <div class="absolute bottom-10 right-16 w-[500px] h-[500px] bg-violet-500/20 rounded-full blur-[220px] animate-pulse-slow"></div>
  <div class="absolute inset-0 bg-[url('https://www.transparenttextures.com/patterns/dark-mosaic.png')] opacity-10"></div>

  <!-- üåü HEADER -->
  <header
    class="relative z-10 max-w-7xl mx-auto mb-10 flex flex-col md:flex-row items-start md:items-center justify-between"
  >
    <div>
      <h1
        class="text-5xl font-extrabold tracking-tight bg-gradient-to-r from-pink-400 to-purple-300 bg-clip-text text-transparent drop-shadow-[0_0_15px_rgba(255,0,150,0.3)]"
      >
        üë• Photo Contacts
      </h1>
      <p class="text-slate-300 mt-2 text-sm md:text-base">
        Keep your loved ones one tap away üíú
      </p>
    </div>

    <div class="flex gap-3 mt-6 md:mt-0">
      <input
        type="text"
        [(ngModel)]="searchTerm"
        (keyup.enter)="onSearch()"
        placeholder="Search by name, relationship or number..."
        class="px-4 py-2 w-72 rounded-2xl bg-white/5 border border-white/10 placeholder:text-slate-300/60 
               focus:ring-2 focus:ring-pink-400 focus:border-pink-400 outline-none transition"
      />
      <button
        (click)="onSearch()"
        class="px-6 py-2 rounded-2xl bg-gradient-to-r from-pink-400 to-amber-300 text-slate-900 font-semibold shadow-lg hover:scale-110 transition-all"
      >
        Search
      </button>
      <button
        (click)="openAddModal()"
        class="px-6 py-2 rounded-2xl bg-gradient-to-r from-emerald-400 to-teal-500 text-slate-900 font-semibold shadow-lg hover:scale-110 transition-all"
      >
        ‚ûï Add New Contact
      </button>
    </div>
  </header>

  <!-- üåà CONTACT LIST -->
  <div
    class="relative z-10 max-w-7xl mx-auto bg-white/10 border border-white/10 rounded-3xl shadow-2xl backdrop-blur-xl p-8 hover:shadow-violet-500/30 transition-all duration-500"
  >
    <div class="flex justify-between items-center mb-5">
      <h2 class="text-2xl font-bold text-violet-300">Contacts</h2>
      <p class="text-sm text-slate-400">
        Showing {{ (contacts$ | async)?.length || 0 }} / {{ total }}
      </p>
    </div>

    <div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-6">
      <ng-container *ngFor="let c of (contacts$ | async)">
        <div
          class="group relative flex items-center gap-4 p-4 bg-white/5 rounded-2xl border border-white/10 hover:border-pink-400/30 shadow-lg hover:shadow-pink-500/20 transition-all duration-500 hover:scale-[1.03]"
        >
          <!-- Avatar -->
          <div
            class="w-16 h-16 rounded-xl overflow-hidden shadow-md bg-gradient-to-br from-pink-500 to-violet-600 flex items-center justify-center cursor-pointer transform group-hover:scale-110 transition-all"
            (click)="openImage(c.photoUrl)"
          >
            <img
              *ngIf="c.photoUrl"
              [src]="c.photoUrl"
              class="object-cover w-full h-full"
            />
            <span *ngIf="!c.photoUrl" class="font-bold text-white text-xl">
              {{ c.name.charAt(0) }}
            </span>
          </div>

          <!-- Info -->
          <div class="flex-1 min-w-0">
            <div class="text-lg font-semibold truncate">{{ c.name }}</div>
            <div class="text-sm text-slate-300/80 truncate">
              {{ c.relationship }}
            </div>
            <div class="text-xs text-slate-400 mt-1 truncate">
              {{ c.phone }}
            </div>
          </div>

          <!-- Actions -->
          <div class="flex gap-2">
            <button
              (click)="editContact(c)"
              title="Edit"
              class="p-2 rounded-full bg-white/10 border border-white/20 text-amber-300 hover:scale-110 hover:shadow-lg transition"
            >
              ‚úèÔ∏è
            </button>
            <a
              [href]="'tel:' + c.phone"
              title="Call"
              class="p-2 rounded-full bg-gradient-to-br from-green-400 to-emerald-500 text-white hover:scale-110 hover:rotate-3 transition shadow-lg"
            >
              üìû
            </a>
            <button
              (click)="deleteContact(c.id)"
              title="Delete"
              class="p-2 rounded-full bg-gradient-to-br from-rose-500 to-red-700 text-white hover:scale-110 hover:rotate-3 transition shadow-lg"
            >
              üóëÔ∏è
            </button>
          </div>
        </div>
      </ng-container>
    </div>

    <!-- PAGINATION -->
    <div
      class="mt-8 flex items-center justify-between text-sm text-slate-300"
    >
      <span>Page {{ page + 1 }} of {{ totalPages }}</span>
      <div class="flex gap-2">
        <button
          (click)="prevPage()"
          [disabled]="page === 0"
          class="px-4 py-1 bg-white/10 border border-white/20 rounded-xl hover:bg-white/20 transition disabled:opacity-40"
        >
          Prev
        </button>
        <button
          (click)="nextPage()"
          [disabled]="(page + 1) * size >= total"
          class="px-4 py-1 bg-white/10 border border-white/20 rounded-xl hover:bg-white/20 transition disabled:opacity-40"
        >
          Next
        </button>
      </div>
    </div>
  </div>

  <!-- ü™Ñ ADD / EDIT MODAL -->
  <div
    *ngIf="showAddModal"
    class="fixed inset-0 bg-black/70 flex items-center justify-center z-50 animate-fade-in"
  >
    <div
      class="relative bg-white/10 border border-white/10 rounded-3xl shadow-2xl backdrop-blur-2xl p-8 w-[90%] md:w-[450px] animate-scale-in"
    >
      <button
        (click)="closeAddModal()"
        class="absolute -top-3 -right-3 bg-rose-500 text-white w-8 h-8 rounded-full hover:bg-rose-600"
      >
        ‚úï
      </button>
      <h2
        class="text-2xl font-bold text-pink-300 mb-6 flex items-center gap-2 justify-center"
      >
        {{ editingContactId ? 'Edit Contact' : 'Add New Contact' }}
      </h2>

      <form
        [formGroup]="form"
        (ngSubmit)="addOrUpdateContact()"
        class="space-y-4"
      >
        <div>
          <label class="block text-sm mb-1 text-slate-300">Full Name</label>
          <input
            formControlName="name"
            type="text"
            placeholder="e.g. Sarah Connor"
            class="w-full px-4 py-2 bg-white/5 border border-white/10 rounded-xl focus:ring-2 focus:ring-pink-400 outline-none transition"
          />
        </div>

        <div>
          <label class="block text-sm mb-1 text-slate-300">Relationship</label>
          <input
            formControlName="relationship"
            type="text"
            placeholder="e.g. Sister"
            class="w-full px-4 py-2 bg-white/5 border border-white/10 rounded-xl focus:ring-2 focus:ring-pink-400 outline-none transition"
          />
        </div>

        <div>
          <label class="block text-sm mb-1 text-slate-300">Phone Number</label>
          <input
            formControlName="phone"
            type="text"
            placeholder="+91 98765 43210"
            class="w-full px-4 py-2 bg-white/5 border border-white/10 rounded-xl focus:ring-2 focus:ring-pink-400 outline-none transition"
          />
        </div>

        <div>
          <label class="block text-sm mb-1 text-slate-300">Profile Photo</label>
          <div class="flex items-center gap-4">
            <label
              class="cursor-pointer px-4 py-2 bg-white/10 border border-white/20 rounded-xl hover:bg-white/20 transition flex items-center gap-2"
            >
              <input
                #fileInput
                (change)="onFileChange($event)"
                type="file"
                accept="image/*"
                class="hidden"
              />
              üìÅ Upload
            </label>

           <div
  class="w-16 h-16 rounded-xl bg-white/5 border border-white/10 flex items-center justify-center relative"
>
  <img *ngIf="previewUrl" [src]="previewUrl" class="object-cover w-full h-full" />
  <span *ngIf="!previewUrl" class="text-xs text-slate-400">No Image</span>

  <!-- Delete button -->
  <button
    *ngIf="previewUrl"
    (click)="previewUrl = null; form.get('photo')?.setValue(null)"
    class="absolute -top-1 -right-1 w-5 h-5 bg-rose-500 text-white rounded-full text-xs flex items-center justify-center hover:bg-rose-600 z-10"
    title="Delete Image"
  >
    ‚úï
  </button>
</div>

          </div>
        </div>

        <div class="flex gap-3 pt-2">
          <button
            type="submit"
            [disabled]="uploading"
            class="flex-1 py-2 rounded-xl bg-gradient-to-r from-emerald-400 to-teal-500 text-slate-900 font-semibold shadow-lg hover:scale-105 transition-all"
          >
            {{
              uploading
                ? (editingContactId ? 'Updating...' : 'Adding...')
                : (editingContactId
                    ? 'Update Contact'
                    : 'Add Contact')
            }}
          </button>
        </div>
      </form>
    </div>
  </div>
   <div *ngIf="modalImageUrl" class="fixed inset-0 bg-black/70 flex items-center justify-center z-50">
    <div class="relative">
      <button (click)="closeImage()" class="absolute -top-3 -right-3 bg-rose-500 text-white w-8 h-8 rounded-full hover:bg-rose-600">‚úï</button>
      <img [src]="modalImageUrl" class="max-h-[70vh] max-w-[70vw] rounded-2xl border-4 border-white/20 shadow-2xl"/>
    </div>
  </div>
  <!-- ‚úÖ SUCCESS TOAST -->
  <div
    *ngIf="toastVisible"
    class="fixed right-6 bottom-6 bg-gradient-to-r from-emerald-400 to-teal-500 text-slate-900 px-5 py-3 rounded-xl shadow-xl font-semibold z-50 animate-slide-up"
  >
    {{ toastMessage }}
  </div>
</div>

<!-- üå† ANIMATIONS -->
<style>
@keyframes fade-in {
  from { opacity: 0; }
  to { opacity: 1; }
}
@keyframes scale-in {
  from { transform: scale(0.8); opacity: 0; }
  to { transform: scale(1); opacity: 1; }
}
@keyframes slide-up {
  from { transform: translateY(30px); opacity: 0; }
  to { transform: translateY(0); opacity: 1; }
}
.animate-fade-in { animation: fade-in 0.3s ease-out; }
.animate-scale-in { animation: scale-in 0.3s ease-out; }
.animate-slide-up { animation: slide-up 0.4s ease-out; }
</style>
