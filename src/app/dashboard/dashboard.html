<div
  class="min-h-screen w-full flex flex-col 
            bg-gradient-to-tr from-indigo-950 via-purple-950 to-pink-950 
            text-white relative overflow-hidden rounded-xl">

  <!-- Floating Glows -->
  <div class="absolute top-20 left-10 w-[400px] h-[400px] bg-pink-500 opacity-30 blur-[160px] animate-pulse-slow"></div>
  <div class="absolute bottom-20 right-10 w-[400px] h-[400px] bg-indigo-400 opacity-20 blur-[180px] animate-pulse-slow"></div>

 <!-- âœ… FIXED ALERT SECTION -->
<div *ngIf="alerts && alerts.length > 0" class="fixed top-10 right-6 z-[9999] space-y-4 ">

  <div
    *ngFor="let alert of alerts"
    class="relative overflow-hidden w-[340px] md:w-[400px] p-5 rounded-2xl 
           shadow-[0_0_25px_rgba(255,0,70,0.6)] 
           bg-gradient-to-br from-red-600 via-red-500 to-pink-500 
           border border-red-400 text-white backdrop-blur-md animate-alert-pop group"
  >
    <!-- Glowing Background -->
    <div class="absolute -top-10 -left-10 w-40 h-40 bg-pink-400 opacity-40 blur-[100px] pointer-events-none"></div>
    <div class="absolute -bottom-10 -right-10 w-32 h-32 bg-yellow-400 opacity-30 blur-[90px] pointer-events-none"></div>

    <!-- Alert Header -->
    <div class="flex items-center justify-between relative z-20 mb-3">
      <div class="flex items-center gap-2">
        <span class="bg-white/20 p-2 rounded-full animate-pulse shadow-inner shadow-yellow-200">ğŸš¨</span>
        <h3 class="text-lg font-extrabold tracking-wide drop-shadow-lg">EMERGENCY ALERT</h3>
      </div>

      <!-- âœ… Replaced Navigate Button with Google Maps Icon -->
      <button
  (click)="getDirectionsToPatient(alert.latitude, alert.longitude)"
  class="ml-4 p-2 rounded-full bg-white/25 hover:bg-white/40 
         text-white shadow-md hover:shadow-lg 
         transition-all duration-150 z-[10000]"
  title="Open Google Maps for directions"
  style="animation: none !important; transform: none !important;">
  <!-- Google Maps SVG Icon -->
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" 
       fill="currentColor" class="w-6 h-6 text-yellow-300 drop-shadow">
    <path d="M12 2C8.14 2 5 5.14 5 9c0 5.25 7 13 7 13s7-7.75 7-13c0-3.86-3.14-7-7-7zm0 9.5c-1.38 0-2.5-1.12-2.5-2.5S10.62 6.5 12 6.5s2.5 1.12 2.5 2.5S13.38 11.5 12 11.5z"/>
  </svg>
</button>

    </div>

    <!-- Alert Content -->
    <div class="relative z-10">
     <p class="text-base font-medium leading-snug tracking-wide italic text-yellow-100 mb-3 ">
  "{{ alert.message }}"
</p>


      <div class="flex flex-col gap-1 text-sm text-white/90">
        <div class="flex items-center gap-2">
          <span class="text-yellow-300">ğŸ‘¤</span>
          <span><strong>Patient:</strong> {{ alert.patientName }}</span>
        </div>
        <div class="flex items-center gap-2">
          <span class="text-blue-300">ğŸ“</span>
          <span><strong>Location:</strong> 
            {{ alert.latitude | number:'1.4-4' }}, 
            {{ alert.longitude | number:'1.4-4' }}
          </span>
        </div>
      </div>
    </div>

    <!-- Animated Border -->
    <div class="absolute inset-0 rounded-2xl border-[3px] border-transparent animate-border-glow pointer-events-none"></div>

    <!-- Progress Bar -->
    <div class="absolute bottom-0 left-0 h-[4px] bg-gradient-to-r from-yellow-400 via-pink-500 to-red-600 animate-progress w-full"></div>

  </div>
</div>


  <!-- Header -->
  <header class="flex flex-col md:flex-row justify-between items-start md:items-center p-8 z-10">
    <div>
      <h1 class="text-4xl font-extrabold tracking-wide drop-shadow-lg">
        Welcome back, <span class="text-yellow-300">{{ user?.username }}</span>
      </h1>
      <p class="text-sm opacity-70 mt-2">Hereâ€™s your personalized memory dashboard âœ¨</p>
    </div>
    <span *ngIf="user?.isAlzheimer"
      class="px-4 py-1 bg-red-500/20 text-red-300 text-sm rounded-full mt-4 md:mt-0 shadow-md">
      ğŸ§  Alzheimer Patient
    </span>
  </header>

  <!-- TODAY'S DATE & MOTIVATION -->
  <section class="px-8 mb-10 z-10">
    <div
      class="bg-gradient-to-r from-purple-600 via-pink-500 to-yellow-400 
             text-white p-6 rounded-2xl shadow-2xl flex flex-col md:flex-row 
             justify-between items-center hover:scale-105 transition-all duration-500">

      <div>
        <h2 class="text-2xl font-bold drop-shadow-lg">
          ğŸ“… {{ getTodayDate() }}
        </h2>
        <p class="text-sm opacity-90 mt-1">Your special day starts here ğŸ’œ</p>
      </div>

      <div class="mt-4 md:mt-0">
        <p class="text-lg font-semibold italic text-center md:text-right">
          "{{ motivationMessage }}"
        </p>
      </div>
    </div>
  </section>

  <!-- KPI CARDS -->
  <section class="grid grid-cols-1 md:grid-cols-3 gap-6 px-8 mb-12 z-10">
    <div
      class="bg-white/10 rounded-2xl p-6 shadow-2xl backdrop-blur-md border border-white/10 hover:scale-105 transition-all duration-300">
      <div class="flex justify-between items-center">
        <p class="text-sm opacity-80">Top Category</p>
        <span class="text-yellow-300 text-xl">ğŸ·ï¸</span>
      </div>
      <h2 class="text-3xl font-bold mt-2 text-yellow-300 drop-shadow">{{ getTopCategory() }}</h2>
      <p class="text-xs text-white/60 mt-2">Your most used category</p>
    </div>

    <div
      class="bg-white/10 rounded-2xl p-6 shadow-2xl backdrop-blur-md border border-white/10 hover:scale-105 transition-all duration-300">
      <div class="flex justify-between items-center">
        <p class="text-sm opacity-80">Total Memories</p>
        <span class="text-yellow-300 text-xl">ğŸ“š</span>
      </div>
      <h2 class="text-3xl font-bold mt-2 text-green-400 drop-shadow">{{ memories.length || 0 }}</h2>
      <p class="text-xs text-white/60 mt-2">All memories uploaded</p>
    </div>

    <div
      class="bg-white/10 rounded-2xl p-6 shadow-2xl backdrop-blur-md border border-white/10 hover:scale-105 transition-all duration-300">
      <div class="flex justify-between items-center">
        <p class="text-sm opacity-80">Latest Upload</p>
        <span class="text-yellow-300 text-xl">ğŸ•’</span>
      </div>
      <h2 class="text-2xl font-semibold mt-2 text-white truncate">{{ recentMemories[0]?.title || '-' }}</h2>
      <p class="text-xs text-white/60 mt-1">{{ recentMemories[0]?.createdAt | date:'short' }}</p>
    </div>
  </section>

  <!-- Charts Section -->
  <section class="grid grid-cols-1 lg:grid-cols-3 gap-8 px-8 mb-16 z-10">
    <!-- PIE CHART -->
    <div
      class="bg-white/10 rounded-2xl p-6 shadow-2xl backdrop-blur-md border border-white/10 hover:scale-110 transition-all duration-500">
      <h3 class="text-lg font-semibold mb-4 text-yellow-300">Category Distribution</h3>
      <div class="h-[260px] flex justify-center items-center">
        <canvas #pieChart></canvas>
      </div>
    </div>

    <!-- BAR CHART -->
    <div
      class="bg-white/10 rounded-2xl p-6 shadow-2xl backdrop-blur-md border border-white/10 hover:scale-105 transition-all duration-500">
      <h3 class="text-lg font-semibold mb-4 text-yellow-300">Upload Frequency</h3>
      <div class="h-[260px] flex justify-center items-center">
        <canvas #barChart></canvas>
      </div>
    </div>

    <!-- LINE CHART -->
    <div
      class="bg-white/10 rounded-2xl p-6 shadow-2xl backdrop-blur-md border border-white/10 hover:scale-110 transition-all duration-500">
      <h3 class="text-lg font-semibold mb-4 text-yellow-300">Memory Trend</h3>
      <div class="h-[260px] flex justify-center items-center">
        <canvas #lineChart></canvas>
      </div>
    </div>
  </section>

 <!-- ğŸ§¾ RECENT MEMORIES -->
<!-- ğŸ§¾ RECENT MEMORIES -->
<section class="px-6 md:px-8 pb-24 pt-8 z-10 w-full">
  <h2
    class="text-2xl md:text-3xl font-extrabold mb-8 md:mb-10 text-center tracking-wide text-yellow-300 drop-shadow-lg flex items-center justify-center gap-3">
    <span>ğŸ§¾</span> Recent Memories
  </h2>

  <!-- âœ… Responsive Grid -->
  <div
    class="grid gap-6 sm:gap-8 justify-items-center transition-all duration-300
           grid-cols-1 sm:grid-cols-2 md:grid-cols-3 lg:grid-cols-4 xl:grid-cols-5">

    <!-- ğŸ§  Memory Card -->
    <div *ngFor="let memory of recentMemories"
      class="relative bg-gradient-to-tr from-purple-900 via-purple-900 to-purple-900 
             border border-white/10 rounded-3xl p-4 sm:p-5 
             w-full max-w-[220px] sm:max-w-[240px] md:max-w-[260px] 
             backdrop-blur-xl shadow-lg text-white 
             hover:scale-105 hover:shadow-2xl hover:shadow-pink-400/40 
             transition-all duration-300 overflow-hidden">

      <!-- âœ¨ Glow Overlay -->
      <div
        class="absolute inset-0 bg-gradient-to-br from-pink-400/10 via-purple-400/10 to-transparent 
               opacity-0 hover:opacity-30 blur-2xl transition-all duration-500">
      </div>

      <div class="relative z-10 flex flex-col justify-between h-full">
        <div>
          <!-- ğŸ·ï¸ Title -->
          <h3 class="font-bold text-base sm:text-lg truncate flex items-center gap-2">
            <span class="text-yellow-300">âœ¨</span> {{ memory.title }}
          </h3>

          <!-- Category -->
          <p
            class="inline-flex items-center gap-2 text-xs font-semibold px-3 py-1 rounded-full
                   bg-indigo-800/60 border border-indigo-400/20 text-indigo-100 shadow-sm mt-2">
            ğŸ·ï¸ {{ memory.category === 'other' ? memory.customCategory : memory.category }}
          </p>

          <!-- Description -->
          <p
            class="text-xs sm:text-sm leading-relaxed text-gray-100/90 bg-white/5 rounded-lg p-2 mt-3 italic 
                   border border-white/10 shadow-inner line-clamp-3">
            {{ memory.description }}
          </p>
        </div>

        <!-- Timestamp -->
        <div class="flex justify-between items-center mt-4 text-[11px] sm:text-xs text-gray-300">
          <p class="flex items-center gap-1 truncate">
            <span class="text-green-400">â°</span>
            {{ memory.createdAt | date:'MMM d' }}
          </p>
        </div>
      </div>
    </div>
  </div>
</section>


  <div *ngIf="activeRoutineNotification" 
     class="fixed inset-0 z-50 flex items-center justify-center bg-black bg-opacity-90 backdrop-blur-sm p-4">
  <div class="bg-gray-900 border-4 border-indigo-500 rounded-xl shadow-2xl max-w-lg w-full p-8 text-center animate-pulse-slow">
    <h3 class="text-4xl font-extrabold text-pink-400 mb-6">Routine Check-in!</h3>
    
    <p class="text-3xl text-white mb-8">{{ activeRoutineNotification.question }}</p>
    
    <div class="flex flex-col space-y-4">
      <button 
        (click)="respondToRoutine('YES')" 
        class="bg-green-600 hover:bg-green-700 text-white text-2xl font-bold py-4 rounded-lg shadow-md transition duration-300 transform hover:scale-105"
      >
        YES
      </button>
      <button 
        (click)="respondToRoutine('NO')" 
        class="bg-red-600 hover:bg-red-700 text-white text-2xl font-bold py-4 rounded-lg shadow-md transition duration-300 transform hover:scale-105"
      >
        NO
      </button>
    </div>
    
    <p class="mt-6 text-sm text-gray-400">Please tap a button to confirm your status.</p>
  </div>
</div>
<!-- Routine Notification Modal -->
<div *ngIf="activeRoutineNotification" class="routine-popup">
  <h3>{{ activeRoutineNotification.question }}</h3>
  <button (click)="respondToRoutine('yes')">Yes</button>
  <button (click)="respondToRoutine('no')">No</button>
</div>

  <!-- Footer -->
  <footer class="text-center py-6 text-sm opacity-70 mt-8 z-10">
    Â© 2025 Memory Care â€¢ Designed with ğŸ’œ for Compassion
  </footer>
</div>
